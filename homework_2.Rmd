---
title: "Homework 1"
author: "Mingyin Wang"
date: 2024-09-28
output: github_document
---

```{r, echo = FALSE}
library(tidyverse)
library(readxl)
library(haven)
```

## Problem 2
load and clean mr trash wheel dataset
```{r}
mr_trash_wheel = read_excel("data/202409 Trash Wheel Collection Data.xlsx", sheet = "Mr. Trash Wheel", skip = 1) |>
  janitor::clean_names() |>
  filter(!is.na(dumpster)) |>
  mutate(
    sports_balls = as.integer(round(sports_balls)), 
    source = "Mr. Trash Wheel"
  )
mr_trash_wheel
```

load and clean prof trash wheel dataset
```{r}
prof_trash_wheel = read_excel("data/202409 Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel", skip = 1) |>
  janitor::clean_names() |>
  filter(!is.na(dumpster)) |>
  mutate(
   year = as.character(year), 
    source = "Professor Trash Wheel"
  )
prof_trash_wheel
```


load and clean Gwynnda trash wheel dataset

```{r}
gwynnda_trash_wheel = read_excel("data/202409 Trash Wheel Collection Data.xlsx", sheet = "Gwynnda Trash Wheel", skip = 1) |>
  janitor::clean_names() |>
  filter(!is.na(dumpster)) |>
  mutate(
   year = as.character(year), 
    source = "Gwynnda Trash Wheel"
  )
gwynnda_trash_wheel
```

combine three dataset
```{r}
trash_wheel_data = 
  bind_rows(mr_trash_wheel, prof_trash_wheel, gwynnda_trash_wheel) |> 
  relocate(source)
trash_wheel_data
```

total weight collected by prof trash wheel

```{r}
total_weight_pro = 
  trash_wheel_data |>
  filter(source == "Professor Trash Wheel") |> 
  summarize(total_weight = sum(weight_tons, na.rm = TRUE))
total_weight_pro
```
The total weight collected by prof trash wheel is `r total_weight_pro` tons.

Total cigarette butts collected by Gwynnda in June 2022
```{r}
tot_butts_june_2022=
   trash_wheel_data |> 
    filter(source == "Gwynnda Trash Wheel", month =="June", year == "2022") |> 
  summarize(total_weight = sum(weight_tons, na.rm = TRUE))

tot_butts_june_2022
```
The total cigarette butts collected by Gwynnda in June 2022 is `r tot_butts_june_2022` tons. 

## Problem 3
load the dataset and did some cleaning
```{r}
bakers_df = read_csv("./data/bakers.csv", na = c("NA", ".", "", "N/A")) |> 
  janitor::clean_names() |>

 mutate(
    series = as.numeric(series), 
   baker =  word(baker_name, 1), 
   baker = str_to_lower(str_trim(baker)
   ))

bakes_df = read_csv("./data/bakes.csv", na = c("NA", ".", "", "N/A")) |> 
  janitor::clean_names() |>
  mutate(
    series = as.numeric(series),
    episode = as.numeric(episode), 
    baker = str_to_lower(str_trim(baker)
    ))

results_df = read_csv("./data/results.csv", na = c("NA", ".", "", "N/A"), skip = 2) |> 
  janitor::clean_names() |>
  
  mutate(series = as.numeric(series),
         episode = as.numeric(episode), 
         baker = str_to_lower(str_trim(baker))
         )
bakers_df
```
use `anti_join()` to compare two datasets

```{r}
anti_join(bakes_df, results_df, by = c("series", "episode", "baker"))
anti_join(results_df, bakes_df, by = c("series", "episode", "baker"))
anti_join(bakers_df, bakes_df, by = c("baker", "series"))
anti_join(bakes_df, bakers_df, by = c("baker", "series"))
```

merge all three

```{r}
final_df = bakes_df |>
  full_join(bakers_df, by = c("baker", "series")) |>
  full_join(results_df, by = c("series", "episode", "baker"))

head(final_df)
write_csv(final_df, "./data/final_df.csv")
```



